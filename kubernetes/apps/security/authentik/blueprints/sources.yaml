---
# yaml-language-server: $schema=https://version-2024-12.goauthentik.io/blueprints/schema.json
# yamllint disable
version: 1
metadata:
  name: STONEHEDGES-sources
entries:
  - model: authentik_sources_plex.plexsource
    identifiers:
      name: STONEHEDGES-sources-plex
    attrs:
      name: Plex
      slug: plex
      enabled: true
      client_id: !Env PLEX_CLIENT_ID
      plex_token: !Env PLEX_TOKEN
      allow_friends: false
      user_matching_mode: "email_link"
      allowed_servers:
        - !Env PLEX_SERVER_ID
      authentication_flow: !Find [authentik_flows.flow, [slug, "default-source-authentication"],]
      enrollment_flow: !Find [authentik_flows.flow, [slug, "default-source-enrollment"],]
  - model: authentik_sources_oauth.oauthsource
    identifiers:
      name: STONEHEDGES-sources-apple
    attrs:
      name: Apple
      slug: apple
      enabled: true
      consumer_key: !Env APPLE_CONSUMER_KEY
      consumer_secret: !Env APPLE_CONSUMER_SECRET
      provider_type: apple
      user_matching_mode: "email_link"
      authentication_flow: !Find [authentik_flows.flow, [slug, "default-source-authentication"],]
      enrollment_flow: !Find [authentik_flows.flow, [slug, "default-source-enrollment"],]
