{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "packageRules": [
    // Bootstrap and Kubernetes Sync Groups
    {
      "description": "CoreDNS - Bootstrap and Kubernetes Sync",
      "groupName": "coredns-all",
      "matchPackageNames": [
        "coredns",
        "ghcr.io/coredns/charts/coredns"
      ],
      "matchDatasources": ["helm", "docker"],
      "commitMessageTopic": "coredns"
    },
    {
      "description": "External Secrets - Bootstrap and Kubernetes Sync", 
      "groupName": "external-secrets-all",
      "matchPackageNames": [
        "external-secrets",
        "ghcr.io/external-secrets/charts/external-secrets"
      ],
      "matchDatasources": ["helm", "docker"],
      "commitMessageTopic": "external-secrets"
    },
    {
      "description": "Flux Operator - Bootstrap and Kubernetes Sync",
      "groupName": "flux-operator-all",
      "matchPackageNames": [
        "flux-operator",
        "ghcr.io/controlplaneio-fluxcd/charts/flux-operator"
      ],
      "matchDatasources": ["helm", "docker"],
      "commitMessageTopic": "flux-operator"
    },
    {
      "description": "Flux Instance - Bootstrap and Kubernetes Sync",
      "groupName": "flux-instance-all",
      "matchPackageNames": [
        "flux-instance",
        "ghcr.io/controlplaneio-fluxcd/charts/flux-instance"
      ],
      "matchDatasources": ["helm", "docker"],
      "commitMessageTopic": "flux-instance"
    },
    {
      "description": "Cilium - Bootstrap and Kubernetes Sync",
      "groupName": "cilium-all",
      "matchPackageNames": [
        "cilium",
        "cilium/cilium"
      ],
      "matchDatasources": ["helm"],
      "commitMessageTopic": "cilium"
    },
    {
      "description": "Spegel - Bootstrap and Kubernetes Sync",
      "groupName": "spegel-all",
      "matchPackageNames": [
        "spegel",
        "ghcr.io/spegel-org/helm-charts/spegel"
      ],
      "matchDatasources": ["helm", "docker"],
      "commitMessageTopic": "spegel"
    },
    {
      "description": "Cert-Manager - Bootstrap and Kubernetes Sync",
      "groupName": "cert-manager-all",
      "matchPackageNames": [
        "cert-manager",
        "quay.io/jetstack/charts/cert-manager"
      ],
      "matchDatasources": ["helm", "docker"],
      "commitMessageTopic": "cert-manager"
    },
    // Critical Infrastructure Groups
    {
      "description": "Flux Controllers Group",
      "groupName": "flux-controllers",
      "matchPackagePatterns": ["fluxcd/.*-controller"],
      "matchDatasources": ["docker", "github-releases"],
      "group": {
        "commitMessageTopic": "Flux controllers"
      },
      "separateMinorPatch": true
    },
    {
      "description": "Rook-Ceph Group",
      "groupName": "rook-ceph",
      "matchPackagePatterns": ["rook/rook", "rook/ceph", "quay.io/ceph/.*"],
      "matchDatasources": ["docker", "helm"],
      "group": {
        "commitMessageTopic": "Rook-Ceph storage"
      },
      "separateMinorPatch": true
    },
    
    // Application Groups
    {
      "description": "Media Apps - Arr Stack",
      "groupName": "arr-stack",
      "matchPackageNames": [
        "ghcr.io/home-operations/sonarr",
        "ghcr.io/home-operations/radarr",
        "ghcr.io/home-operations/lidarr",
        "ghcr.io/home-operations/readarr",
        "ghcr.io/home-operations/bazarr",
        "ghcr.io/home-operations/prowlarr"
      ],
      "group": {
        "commitMessageTopic": "*arr media stack"
      },
      "separateMinorPatch": false
    },
    {
      "description": "Media Apps - Downloaders",
      "groupName": "media-downloaders",
      "matchPackageNames": [
        "ghcr.io/home-operations/sabnzbd",
        "ghcr.io/home-operations/qbittorrent"
      ],
      "group": {
        "commitMessageTopic": "media downloaders"
      },
      "separateMinorPatch": true
    },
    
    // Observability Stack
    {
      "description": "Prometheus Stack",
      "groupName": "kube-prometheus-stack",
      "matchPackagePatterns": [
        "prometheus-community/kube-prometheus-stack",
        "quay.io/prometheus/.*",
        "grafana/grafana"
      ],
      "group": {
        "commitMessageTopic": "monitoring stack"
      },
      "separateMinorPatch": true
    },
    {
      "description": "Loki Stack",
      "groupName": "loki-stack",
      "matchPackagePatterns": [
        "grafana/loki.*",
        "grafana/promtail"
      ],
      "group": {
        "commitMessageTopic": "Loki logging"
      }
    },
    
    // Security Groups
    {
      "description": "Cert-manager Group",
      "groupName": "cert-manager",
      "matchPackagePatterns": ["cert-manager/.*", "quay.io/jetstack/.*"],
      "group": {
        "commitMessageTopic": "cert-manager"
      },
      "separateMinorPatch": true
    },
    {
      "description": "External Secrets Group",
      "groupName": "external-secrets",
      "matchPackagePatterns": [
        "external-secrets/external-secrets",
        "1password/connect.*"
      ],
      "group": {
        "commitMessageTopic": "secrets management"
      },
      "separateMinorPatch": true
    },
    
    // Infrastructure Groups
    {
      "description": "Storage CSI Drivers",
      "groupName": "csi-drivers",
      "matchPackagePatterns": [
        ".*csi.*",
        "democratic-csi/.*",
        "openebs/.*"
      ],
      "matchDatasources": ["docker", "helm"],
      "group": {
        "commitMessageTopic": "CSI storage drivers"
      },
      "separateMinorPatch": true
    },
    
    // Keep existing groups
    {
      "description": "1Password Connect Group",
      "groupName": "1password-connect",
      "matchPackagePatterns": ["1password/connect"],
      "matchDatasources": ["docker"],
      "group": {
        "commitMessageTopic": "1Password Connect"
      },
      "separateMinorPatch": true
    },
    {
      "description": "Intel Device Plugins Group",
      "groupName": "intel-device-plugins",
      "matchPackagePatterns": ["intel-device-plugins"],
      "matchDatasources": ["helm"],
      "group": {
        "commitMessageTopic": "Intel device plugins"
      },
      "separateMinorPatch": true
    },
    {
      "description": "Talos Group",
      "groupName": "talos",
      "matchPackagePatterns": ["siderolabs/talosctl", "siderolabs/installer"],
      "matchDatasources": ["docker"],
      "group": {
        "commitMessageTopic": "Talos"
      },
      "separateMinorPatch": true
    }
  ]
}